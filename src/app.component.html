<main class="container mx-auto p-4 md:p-8 min-h-screen">

  @if (!showArena()) {
    <header class="text-center mb-8">
      <h1 class="font-medieval text-5xl md:text-7xl text-amber-400 drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)]">
        RPG Deck Builder
      </h1>
      <p class="text-slate-300 text-lg mt-2">Monte seu baralho para a batalha!</p>
    </header>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      
      <!-- Card Collection -->
      <div class="lg:col-span-2 bg-slate-800/50 rounded-2xl p-6 border border-slate-700 shadow-2xl">
        <h2 class="font-medieval text-4xl text-cyan-300 mb-6 sticky top-0 bg-slate-800/80 py-2 backdrop-blur-sm z-10">
          Coleção de Cartas
        </h2>
        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 xl:grid-cols-5 gap-4 h-[70vh] overflow-y-auto pr-2">
          @for (card of allCards(); track card.id) {
            <div (click)="addCardToDeck(card)" [class.opacity-50]="isCardInDeck(card)">
               <app-card [card]="card" [isInDeck]="isCardInDeck(card)" />
            </div>
          }
        </div>
      </div>

      <!-- User Deck -->
      <div class="lg:col-span-1 bg-slate-800/50 rounded-2xl p-6 border border-slate-700 shadow-2xl">
        <div class="sticky top-6">
          <h2 class="font-medieval text-4xl text-rose-400 mb-4">Seu Deck</h2>
          <div class="bg-gray-900/70 rounded-lg p-3 mb-4 flex justify-between items-center border border-slate-600">
            <span class="text-slate-300 font-bold">Custo Médio de Elixir:</span>
            <span class="font-medieval text-3xl text-fuchsia-400">{{ averageElixir() }}</span>
          </div>
          
          <div class="grid grid-cols-2 gap-4 mb-6">
            @for (card of deck(); track $index) {
              @if (card) {
                <div (click)="removeCardFromDeck($index)">
                  <app-card [card]="card" />
                </div>
              } @else {
                <div class="aspect-[3/4] bg-slate-900/50 border-2 border-dashed border-slate-600 rounded-lg flex items-center justify-center">
                  <span class="text-slate-500 text-sm">Vazio</span>
                </div>
              }
            }
          </div>

          <button (click)="enterArena()" [disabled]="!isDeckFull()" 
            class="w-full font-medieval text-3xl py-4 px-6 rounded-lg transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed"
            [class]="isDeckFull() ? 'bg-gradient-to-r from-green-500 to-emerald-600 hover:scale-105 text-white' : 'bg-gray-700 text-gray-400'">
            Batalhar!
          </button>
          @if (!isDeckFull()) {
            <p class="text-center text-sm mt-2 text-slate-400">Complete seu deck com 8 cartas para batalhar.</p>
          }

        </div>
      </div>

    </div>
  } @else {
    <app-arena [deck]="deck()" (exit)="exitArena()" />
  }

</main>